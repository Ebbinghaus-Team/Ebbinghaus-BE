# 학습 루프 서비스 - PRD (v1.8)

---

> 문서 상태: v1.8 (2025-01-23)
>
>
> 문서 개요: 본 문서는 '학습 루프 서비스'의 핵심 기능, 사용자 시나리오, 그리고 정책을 정의하는 제품 요구 문서(PRD)입니다.
>
> v1.8 변경 이력: '문제 풀이 및 상태 전이 정책' 상세 명세 추가. (첫 시도 기준, 재시도 정책, 비복습 문제 풀이 docs/desi)
>

## 1. 문제 정의 및 목표 (Problem & Goal)

### 1.1. 문제 상황 (As-Is)

- 학습 직후의 이해가 장기적으로 유지되지 않고 쉽게 증발함.
- 복습의 적절한 타이밍(언제)과 방식(무엇을)을 스스로 관리하기 어려움.
- 개념을 노션/워드 등에 정리하는 것은 시간이 오래 걸리고, 다시 복습하기 어려움.

### 1.2. 핵심 문제 (Pain Point)

- 학습 내용이 장기 기억으로 전환되지 않음.
- 반복 복습의 실행과 유지가 어려움.

### 1.3. 목표 (To-Be)

- 학습자가 **스스로 문제를 만들고, 정해진 주기(1일/7일)에 다시 푸는 구조**를 제공한다.
- 이를 통해 '능동적 인출(Active Recall)'과 '간헐적 복습'을 시스템화하여, 단기 기억으로 전환시키는 학습 루프를 구현한다.

---

## 2. 핵심 기능 명세 (Core Features)

### 2.1. 개인/그룹 스터디 (Study Rooms)

- **Why:** 학습 내용을 주제별, 목적별(개인/그룹)로 분리하여 관리합니다.
- **What:** 개인 전용 '개인 스터디'와 여러 사용자가 참여하는 '그룹 스터디' 공간을 제공합니다.

### 2.2. 문제 등록 (Problem Creation)

- **Why:** 문제 생성은 메타인지 활동의 시작점이며, 이 과정을 간편하게 만들어야 합니다.
- **What:** 객관식, OX, 단답형, 서술형 4가지 템플릿을 제공합니다.

### 2.3. "Two-Strike" 복습 모델 (Spaced Repetition Model)

- **Why:** 망각 곡선에 따라, 명확한 규칙으로 복습을 자동화합니다.
- **What:**
    - 1차 관문(1일차)
    - 2차 관문(7일차)
    - 졸업

  의 2단계 성공 모델. 오답 시 하위 관문으로 강등되어 반복 학습을 유도합니다.


### 2.4. AI 기반 서술형 채점 (AI Subjective Scoring)

- **Why:** 서술형 학습의 모호한 채점 기준을 AI가 '핵심 키워드' 기반으로 보완합니다.
- **What:** 출제자가 등록한 '모범 답안'과 '핵심 키워드'를 기반으로, AI가 사용자의 답안을 채점하고 구조화된 피드백(JSON)을 반환합니다.

### 2.5. 그룹 스터디 & 문제 교환

- **Why:** 타인의 시각으로 만든 문제를 통해 학습 범위를 넓히고 동기를 부여합니다.
- **What:** 그룹 스터디 방에 문제를 생성('그룹 전용 생성')하고, 타인이 만든 문제를 풀며 자신의 복습 주기에 편입시킬 수 있습니다.

### 2.6. 복습 알림 (Email)

- **Why:** 사용자가 복습 시점을 놓치지 않도록 리마인드합니다.
- **What:** 매일 오전 8시, '오늘의 복습' 문제가 있는 사용자에게 이메일을 발송합니다.

---

## 3. 사용자 시나리오 및 상세 기능

### 3.1. 개인 스터디 (Personal Study)

### 3.1.1. 개인 공부방 생성

- 사용자는 '공부방 이름', '카테고리', '설명'을 입력하여 개인 공부방을 생성합니다.

### 3.1.2. 개인 공부방 목록 조회

- 개인 스터디 탭 진입 시, 생성한 공부방 목록을 (완료 문제 수 / 총 문제 수)와 함께 조회합니다.

### 3.1.3. 개인 공부방 대시보드 (전체 현황)

- 목록 상단에 '총 공부방 개수', '총 문제 수', '완료한 문제 수', '전체 진행률 (%)'을 요약합니다.

### 3.1.4. 특정 개인 공부방 입장 (상세 조회)
- 공부방 선택 시, 해당 방의 문제 목록을
    - `전체`, `1차 관문`, `2차 관문`, `완료`

  상태로 필터링하여 조회할 수 있습니다.

  ※ 개인 공부방의 모든 문제는 생성 즉시 복습 주기(GATE_1)에 등록되므로, `미완료` 필터는 제공하지 않습니다.


- 각 문제의 '진행 상태', '유형', '작성일', '마지막 복습일', '복습 횟수'를 확인할 수 있습니다.

### 3.2. 문제 등록 시나리오 (Problem Creation)

### 3.2.1. 문제 생성 (in Study Room)

- '개인' 또는 '그룹' 스터디 방에 입장한 상태에서 '문제 만들기'를 시작합니다.
- 문제 유형 (객관식, OX, 단답형, 서술형)을 선택합니다.

### 3.2.2. 문제 유형별 상세 명세 (Request Data)

[객관식]

: `question`, `choices` (Array), `answer`, `explanation`

[O/X]

: `question`, `answer` (Boolean), `explanation`

[단답형]

: `question`, `answer`, `explanation`

[서술형]

: `question`, `keywords` (Array), `modelAnswer`, `explanation`

### 3.3. 문제 풀이 시나리오 (Problem Solving Flow)

### 3.3.1. 경로 A: '오늘의 복습' (중앙 허브)

- **Why:** 매일 수행해야 할 복습을 한곳에서 모아 제공하여 학습 습관을 형성합니다.
- **What (UX/UI 상세):**
    - **(대시보드)** 화면 상단에 '오늘의 총 문제', '완료한 문제', '미완료 문제', '진행률 (%)'이 노출됩니다.
    - **(문제 목록)** 대시보드 하단에 `관문 상태`(1차/2차), `문제 제목`, `완료 여부`(풀이 전/완료)가 표시된 목록을 제공합니다.
    - **(사용자 행동)** 사용자는 목록에서 '풀이 전' 문제를 **선택하여** `3.3.3. 문제 풀이 화면`으로 진입합니다.
- 오늘의 복습 포함 기준
    - **1. 개인 문제 (Personal Problems):**
        - `1차 관문`: (A) 생성일로부터 1일이 지났거나, (B) 2차 관문 풀이에서 오답(Fail)하여 강등된 문제.
        - `2차 관문`: 1차 관문 통과(정답) 후 7일이 지난 문제.
    - **2. 그룹 문제 (본인 생성):**
        - '그룹 스터디' 방에서 **직접 생성**한 문제는 '개인 문제'와 동일하게 취급됩니다.
        - `1차 관문`: (A) 생성일로부터 1일이 지났거나, (B) 2차 관문 풀이에서 오답(Fail)하여 강등된 문제.
        - `2차 관문`: 1차 관문 통과(정답) 후 7일이 지난 문제.
    - **3. 그룹 문제 (타인 생성):**
        - **(전제 조건)**: 사용자가 해당 그룹 문제를 **최초 1회 이상 풀이**한 이력이 있어야 합니다. (3.3.2 참조)
        - `1차 관문`: (A) 전제 조건을 만족하고 최초/N차 풀이일로부터 1일이 지났거나, (B) 2차 관문 풀이에서 오답(Fail)하여 강등된 문제.
        - `2차 관문`: 1차 관문 통과(정답) 후 7일이 지난 문제.

### 3.3.2. 경로 B: '공부방별 학습' (개별 진입)

- **Why:** 특정 주제에 집중 학습하고, (타인이 만든) 그룹 문제를 '최초 풀이'하여 복습 주기에 편입(활성화)시키는 경로입니다.
- **What:**
    - 특정 스터디 방에 입장하여, '미완료' (아직 풀지 않은) 그룹 문제 등을 필터링하여 풀이할 수 있습니다.
    - **(그룹 문제 활성화 로직)**: (타인이 만든) 그룹 문제의 '최초 풀이' 시, **정답/오답 결과와 관계없이** 해당 문제는 '1차 관문'(익일 복습)으로 활성화되어 사용자의 개인 복습 주기에 편입됩니다.

### 3.3.3. 문제 풀이 화면 및 채점 로직

- 사용자가 문제를 선택하여 진입하는 핵심 풀이 화면입니다.
- 공통 로직
    - 답안 제출 시, `[유형별 채점 로직]`에 따라 즉시 채점합니다.
    - 채점 완료 후, `[상태 전이 로직]`에 따라 **개인화된 복습 상태**가 업데이트됩니다. (4.5 참조)
    - '목록으로 돌아가기' 선택 시, '오늘의 복습' 목록(3.3.1)에서 해당 문제는 '풀이 완료' 상태로 업데이트됩니다.
- 유형별 채점 로직
    - **(객관식, OX, 단답형):**

      `정답/오답`, `결과`와 `해설`을 보여줍니다.

    - **(서술형 - AI 채점):**
        - **(Success Path):**

          `정답/오답`, `피드백`, `모범 답안`, `해설`을 보여줍니다. (2.4 참조)

        - **(Failure Path - 기술적 예외 처리):** "AI 채점에 실패했습니다. 잠시 후 다시 시도해주세요." 메시지와 "다시 채점하기" 버튼을 제공합니다.

- 상태 전이 로직 (v1.8 추가)
    - **(오늘의 복습 문제 - 첫 시도):**
        - **조건**: `nextReviewDate <= 오늘` 이면서, 오늘 첫 번째 시도인 경우
        - **동작**: 정답/오답 결과에 따라 `Two-Strike 모델` 규칙을 적용하여 `gate` 상태 전이 발생
        - **결과**: 채점 + 상태 전이 (GATE_1→GATE_2, GATE_2→GRADUATED, 오답 시 강등)
    - **(오늘의 복습 문제 - 재시도):**
        - **조건**: 오늘 이미 한 번 이상 풀이한 문제
        - **동작**: 채점만 제공, 상태 변화 없음
        - **결과**: 채점만 (첫 시도 결과가 최종 상태 유지)
    - **(비복습 문제):**
        - **조건**: `nextReviewDate > 오늘`인 미래 문제, 또는 `GRADUATED` 상태 문제
        - **동작**: 채점만 제공, 상태 변화 없음
        - **결과**: 채점만 (복습 주기에 영향 없음)

### 3.4. 그룹 스터디 시나리오 (Group Study)

### 3.4.1. 그룹 스터디 목록 조회 (신규 추가 v1.7)

- '그룹 스터디' 탭에 진입 시, 사용자가 속한 그룹 스터디의 목록을 조회합니다.
- List View Items
    - `groupName` (String): 그룹 스터디 이름
    - `groupDescription` (String): 그룹 스터디 설명
    - `memberCount` (Number): 그룹 스터디 총 인원
    - `problemCount` (Number): 그룹 스터디 총 문제 개수

### 3.4.2. 그룹 스터디 생성

- 사용자가 '그룹 스터디'를 생성하면, 고유한 '그룹 참여 코드'가 발급됩니다.

### 3.4.3. 그룹 스터디 참여

- 방장이 공유한 '그룹 참여 코드'를 입력하여 스터디에 참여합니다.

### 3.4.4. MVP 정책: 그룹 관리

- MVP 범위에서는 '그룹 탈퇴' 및 '스터디원 강퇴' 기능을 지원하지 않습니다. (4.1 참조)

---

## 4. MVP 정책 및 확정 사항

> v1.6까지의 모든 정책 결정을 통합 및 재정리한 확정 사항입니다.
>

### 4.1. 그룹 정책

- **(공유 방식)**: '그룹 전용 생성' 방식을 채택합니다.
- **(멤버 관리)**: MVP 범위에서는 '그룹 탈퇴' 및 '스터디원 강퇴' 기능을 지원하지 않습니다.

### 4.2. AI 채점 정책

- **(적용 범위)**: '서술형' 문제에 한해서만 AI 채점을 적용하며, AI는 구조화된 JSON을 반환합니다.
- **(기술적 예외 처리)**: AI API 응답 실패 시(500 에러 등), "AI 채점에 실패했습니다." 메시지와 "다시 채점하기" 버튼을 제공합니다.
- **(품질 관리)**: AI 채점의 *품질*(부정확 등)에 대한 사용자 피드백 기능은 MVP 범위에서 제외합니다.

### 4.3. 알림 정책

- **(채널)**: '이메일'을 기본 알림 채널로 사용합니다.
- **(발송 시점)**: 매일 오전 8시 (KST 기준) '오늘의 복습' 대상자에게 일괄 발송합니다.
- **(수신 동의)**: 기본 제공(Opt-out) 원칙을 따릅니다. ('설정' 기능 MVP 포함)

### 4.4. 복습 주기 및 UX 정책

- **(문제 풀이 UX)**: '오늘의 복습'은 상단에

  [총 문제, 완료, 미완료, 진행률]

  대시보드를 포함합니다. 문제 목록은

  [관문 상태, 제목, 완료 여부]

  를 표시하며, '풀이 완료' 시 목록에 상태가 업데이트됩니다.

- **(복습 주기 귀속)**: "Two-Strike" 복습 주기는(1차/2차/졸업 상태) 그룹 문제라 할지라도 **철저히 사용자별로 개인화되어 귀속**됩니다.
- **(그룹 문제 편입 정책)**:
    - **(생성자)**: '그룹 스터디' 방에서 문제를 **직접 생성**한 사용자에 한해, 해당 문제는 '개인 문제'로 취급되어 '최초 풀이' 없이 1일 뒤 '1차 관문'에 자동 배정됩니다.
    - **(타 스터디원)**: 타인이 만든 그룹 문제를 **최초 1회 풀이**하면, 그 결과(정/오답)와 **관계없이** 해당 문제는 즉시 개인 복습 주기에 편입되어, '1차 관문' 문제로 배정됩니다 (익일 복습 대상).
- **(일일 복습 제한)**: '제한 없음' 정책을 채택합니다.
- **(복습 이월 정책)**: '오늘의 복습' 목록에서 당일 풀지 않은 문제(1차/2차 관문)는 익일 '오늘의 복습' 목록에 자동으로 다시 포함됩니다. (복습 완료까지 이월됨)

### 4.5. 문제 풀이 및 상태 전이 정책 (v1.8 추가)

> 사용자가 언제든 문제를 풀 수 있지만, 상태 변화는 특정 조건에서만 발생합니다.

#### 4.5.1. 핵심 원칙

- **원칙 1: 유연한 학습 접근**
    - 사용자는 **모든 문제를 언제든 풀 수 있습니다** (복습 예정일과 무관).
    - 예시: 내일 복습 예정인 문제를 미리 풀기, 이미 졸업한 문제 재학습 등

- **원칙 2: 오늘의 복습 문제만 상태 변화**
    - **오늘의 복습 문제**: `nextReviewDate <= 오늘` 또는 `오늘 이미 풀었던 문제`
    - 오늘의 복습 문제를 풀면 → `Two-Strike 모델`에 따라 gate 상태 전이 발생
    - 비복습 문제를 풀면 → 채점만 제공, 복습 주기에 영향 없음

- **원칙 3: 첫 시도 기준 상태 전이**
    - 오늘의 복습 문제를 **오늘 첫 번째로 시도**했을 때의 결과만 상태에 영향
    - 이후 재시도는 채점만 제공 (상태 불변)
    - **공정성 보장**: 첫 시도 정답 후 재시도에서 틀려도 승급 유지, 첫 시도 오답 후 재시도에서 맞춰도 강등 유지

#### 4.5.2. 문제 유형별 처리 정책

| 문제 유형 | 조건 | 처리 내용 | 상태 변화 |
|----------|------|----------|----------|
| **오늘의 복습 문제 (첫 시도)** | `nextReviewDate <= 오늘` AND 오늘 첫 시도 | 채점 + 상태 전이 + 시도 로그 | ✅ 발생 |
| **오늘의 복습 문제 (재시도)** | 오늘 이미 풀었던 문제 | 채점 + 시도 로그 | ❌ 없음 |
| **비복습 문제 (미래)** | `nextReviewDate > 오늘` | 채점 + 시도 로그 | ❌ 없음 |
| **비복습 문제 (졸업)** | `gate = GRADUATED` | 채점 + 시도 로그 | ❌ 없음 |
| **그룹 타인 문제 (첫 풀이)** | 복습 상태 없음 | 채점 + 복습 상태 생성 (GATE_1, 익일 복습) | ⚠️ 생성만 |

#### 4.5.3. 상태 전이 규칙 (Two-Strike Model)

**첫 시도 정답 시**:
- `GATE_1` + 정답 → `GATE_2` (다음 복습: 오늘 + 7일)
- `GATE_2` + 정답 → `GRADUATED` (복습 완료)

**첫 시도 오답 시**:
- `GATE_1` + 오답 → `GATE_1` 유지 (다음 복습: 오늘 + 1일)
- `GATE_2` + 오답 → `GATE_1` 강등 (다음 복습: 오늘 + 1일)

**재시도 (2회차 이상)**:
- 모든 경우 → 상태 불변 (채점만 제공)

#### 4.5.4. 오늘의 복습 목록 일관성 정책

- **문제**: 문제를 풀면 `nextReviewDate`가 미래로 업데이트되어 목록에서 사라지는 현상
- **해결**: 오늘 복습 대상이었던 문제는 오늘 하루 동안 목록에 계속 표시
- **구현**: 문제를 풀면 "오늘 복습 대상이었음"을 기록하여, 이후 조회 시에도 목록에 유지
- **UX 개선**: 사용자는 "오늘 풀었던 문제"를 하루 종일 확인 가능

#### 4.5.5. 필터 일관성 정책

- **문제**: GATE_1 필터로 조회했는데, 문제를 풀어 GATE_2로 승급하면 목록에서 사라지는 현상
- **해결**: 오늘 조회 시점의 관문 상태를 기록하여 필터 일관성 유지
- **예시**: GATE_1 필터로 조회한 문제를 풀어 GATE_2가 되어도, 오늘 하루는 GATE_1 필터에 계속 표시

#### 4.5.6. 재시도 정책

- **허용 범위**: 무제한 재시도 가능 (하루에 같은 문제를 여러 번 풀 수 있음)
- **채점 제공**: 재시도 시에도 정답/오답 채점 결과 제공
- **상태 고정**: 첫 시도 결과가 최종 상태를 결정하므로, 재시도는 상태에 영향 없음
- **학습 목적**: 사용자가 틀린 문제를 다시 풀어보며 학습할 수 있는 기회 제공

---
